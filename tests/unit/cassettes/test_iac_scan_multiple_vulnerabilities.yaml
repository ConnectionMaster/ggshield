interactions:
  - request:
      body: !!binary |
        LS0yZDQ4NzJhZDgxOTczZTc5ZTkwZmJjMWEwNDM0ODI0YQ0KQ29udGVudC1EaXNwb3NpdGlvbjog
        Zm9ybS1kYXRhOyBuYW1lPSJkaXJlY3RvcnkiOyBmaWxlbmFtZT0iZGlyZWN0b3J5Ig0KDQofiwgA
        FmBrZAL/7dO7bsIwGAVgz34Kyw8QbOcCC1LHjt2ryjLBIKsJQb60oIp3rwlDK1XQpUVqOZ8H/4oT
        nyWnmBSTuwezu7dmaT35FeLk3C5EWX3Mx+dSKKkI25ErSCEan+PJbVIz1kfX27lsZtW0ntW1KFRZ
        iqksKYF/z5lWr1xndZ+66LZ5eEndxnqzcJ2LzoYirn6i/00zdlxOa/l5P9VfSiKrqlRNI4RqiFDH
        RZi4Zv/N2kRr0tn3vjv/o6i3YUi+tYyb16CDbZN3ca/XfkhbzvjCLLXdmT7/GZy9UcbsOn8RxpGx
        1i29XnRD+xzYnD1yUYxrIvhTPj/QA6XsUoD26Xjv15S439p8I3ebMY7Ty1k5B1UGAAAAAAAAAAAA
        AAAAAACAG/UOOzvp2QAoAAANCi0tMmQ0ODcyYWQ4MTk3M2U3OWU5MGZiYzFhMDQzNDgyNGEtLQ0K
      headers:
        Accept:
          - '*/*'
        Accept-Encoding:
          - gzip, deflate
        Connection:
          - keep-alive
        Content-Length:
          - '456'
        Content-Type:
          - multipart/form-data; boundary=2d4872ad81973e79e90fbc1a0434824a
        GGShield-Command-Id:
          - a320dc8c-719b-405b-84d3-613efb153913
        GGShield-Command-Path:
          - cli iac scan
        GGShield-OS-Name:
          - ubuntu
        GGShield-OS-Version:
          - '22.04'
        GGShield-Python-Version:
          - 3.10.6
        GGShield-Version:
          - 1.15.1
        User-Agent:
          - pygitguardian/1.6.0 (Linux;py3.10.6) ggshield
        mode:
          - directory
      method: POST
      uri: https://api.gitguardian.com/v1/iac_scan
    response:
      body:
        string:
          '{"id":"0","type":"path_scan","iac_engine_version":"1.7.0","entities_with_incidents":[{"filename":"iac_file_multiple_vulnerabilities.tf","incidents":[{"policy":"Unrestricted
          egress traffic might lead to remote code execution","policy_id":"GG_IAC_0002","severity":"HIGH","component":"aws_security_group.bad_example","line_end":4,"line_start":4,"description":"Open
          egress means that the asset can download data from the whole web.","documentation_url":"https://docs.gitguardian.com/iac-scanning/policies/GG_IAC_0002"},{"policy":"Unrestricted
          ingress traffic leaves assets exposed to remote attacks","policy_id":"GG_IAC_0003","severity":"HIGH","component":"aws_security_group_rule.bad_example","line_end":10,"line_start":10,"description":"A
          security group has open ingress from all IPs, and on all ports. This means
          that the\nassets in this security group are exposed to the whole web.\n\nFurthermore,
          no port range is specified. This\nmeans that some applications running on
          assets of this security group may be reached by\nexternal traffic, while they
          are not expected to do so.","documentation_url":"https://docs.gitguardian.com/iac-scanning/policies/GG_IAC_0003"}]}]}'
      headers:
        access-control-expose-headers:
          - X-App-Version
        allow:
          - POST, OPTIONS
        content-length:
          - '1167'
        content-type:
          - application/json
        cross-origin-opener-policy:
          - same-origin
        date:
          - Mon, 22 May 2023 12:29:11 GMT
        referrer-policy:
          - strict-origin-when-cross-origin
        server:
          - istio-envoy
        strict-transport-security:
          - max-age=31536000; includeSubDomains
        transfer-encoding:
          - chunked
        vary:
          - Accept-Encoding,Cookie
        x-app-version:
          - v2.30.2
        x-content-type-options:
          - nosniff
          - nosniff
        x-envoy-upstream-service-time:
          - '363'
        x-frame-options:
          - DENY
          - SAMEORIGIN
        x-secrets-engine-version:
          - 2.89.0
        x-xss-protection:
          - 1; mode=block
      status:
        code: 200
        message: OK
version: 1
